<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent - Multi-Tools</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles-modal.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <circle cx="12" cy="12" r="10" fill="none" stroke="#6366f1" stroke-width="2" />
                            <path fill="#6366f1" d="M8 12l3 3 5-6" stroke="#6366f1" stroke-width="2" fill="none" />
                        </svg>
                    </span>
                    <h1>AI Agent</h1>
                </div>
                <div class="tool-count-badge" id="toolCountBadge">Loading tools...</div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <span class="nav-section-title">Integrations</span>

                    <!-- Gmail Option -->
                    <button class="nav-item" id="gmailNavItem" data-service="gmail">
                        <div class="nav-item-icon gmail-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#EA4335"
                                    d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Gmail</span>
                        <span class="nav-item-status" id="gmailStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Calendar Option -->
                    <button class="nav-item" id="calendarNavItem" data-service="calendar">
                        <div class="nav-item-icon calendar-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#4285f4"
                                    d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Calendar</span>
                        <span class="nav-item-status" id="calendarStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- GitHub Option -->
                    <button class="nav-item" id="githubNavItem" data-service="github">
                        <div class="nav-item-icon github-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#e6edf3"
                                    d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">GitHub</span>
                        <span class="nav-item-status" id="githubStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Google Chat Option -->
                    <button class="nav-item" id="gchatNavItem" data-service="gchat">
                        <div class="nav-item-icon gchat-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#34a853" d="M3 4h18v12H7l-4 4V4zm4 5h10v2H7V9z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Google Chat</span>
                        <span class="nav-item-status" id="gchatStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Google Drive Option -->
                    <button class="nav-item" id="driveNavItem" data-service="drive">
                        <div class="nav-item-icon drive-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#0f9d58" d="M8.5 3L3 12l2.75 4.5L11.25 7.5z" />
                                <path fill="#f4b400" d="M8.5 3h7L21 12h-7z" />
                                <path fill="#4285f4" d="M5.75 16.5h11.5L21 12h-7L10.25 18z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Google Drive</span>
                        <span class="nav-item-status" id="driveStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Google Sheets Option -->
                    <button class="nav-item" id="sheetsNavItem" data-service="sheets">
                        <div class="nav-item-icon sheets-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#34a853" d="M5 2h10l4 4v16H5z" />
                                <path fill="#fff" d="M9 10h6v1H9zm0 3h6v1H9zm0 3h6v1H9z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Google Sheets</span>
                        <span class="nav-item-status" id="sheetsStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Google Docs Option -->
                    <button class="nav-item" id="docsNavItem" data-service="docs">
                        <div class="nav-item-icon docs-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#4285F4" d="M6 2h8l6 6v12c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2z"/>
                                <path fill="#fff" d="M7 12h10v1.5H7zm0 3h7v1.5H7zm0-6h10v1.5H7z"/>
                            </svg>
                        </div>
                        <span class="nav-item-text">Google Docs</span>
                        <span class="nav-item-status" id="docsStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Outlook Option -->
                    <button class="nav-item" id="outlookNavItem" data-service="outlook">
                        <div class="nav-item-icon outlook-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#0078D4"
                                    d="M24 7.387v10.478c0 .23-.08.424-.238.582a.793.793 0 01-.582.238h-9.462V7.07l1.2.72 8.844-5.073c.158.05.29.147.396.293.106.147.159.312.159.494v.17L24 7.387zM13.718 7.07v12.078H1.077a.83.83 0 01-.618-.259A.861.861 0 010 18.25V4.387c0-.11.037-.18.11-.213l6.6-3.83L13.717 7.07z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Outlook</span>
                        <span class="nav-item-status" id="outlookStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Microsoft Teams Option -->
                    <button class="nav-item" id="teamsNavItem" data-service="teams">
                        <div class="nav-item-icon teams-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#6264A7" d="M20.5 6a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM16 3.5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zM22 9h-4v10c0 .55-.45 1-1 1h-6c0 2.21 1.79 4 4 4h3c2.21 0 4-1.79 4-4V9zM15 8H3c-.55 0-1 .45-1 1v8c0 2.76 2.24 5 5 5h4c2.76 0 5-2.24 5-5V9c0-.55-.45-1-1-1z"/>
                            </svg>
                        </div>
                        <span class="nav-item-text">Teams</span>
                        <span class="nav-item-status" id="teamsStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Timer Tasks Option -->
                    <button class="nav-item" id="timerNavItem" data-service="timer">
                        <div class="nav-item-icon timer-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="#f59e0b"
                                    d="M15 1H9v2h6V1zm-3 4C7.58 5 4 8.58 4 13s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3.65 11.35-4.15-2.5V8h1.5v4.98l3.42 2.06-.77 1.31z" />
                            </svg>
                        </div>
                        <span class="nav-item-text">Timer Tasks</span>
                        <span class="nav-item-status" id="timerStatus">
                            <span class="status-dot disconnected"></span>
                        </span>
                    </button>

                    <!-- Capabilities Option -->
                    <button class="nav-item" id="capabilitiesNavItem">
                        <div class="nav-item-icon capabilities-icon">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path fill="currentColor" d="M22 11.08V12a10 10 0 1 1-5.93-9.14M22 4L12 14.01l-3-3" />
                            </svg>
                        </div>
                        <span class="nav-item-text">All Tools</span>
                    </button>
                </div>

                <div class="nav-section">
                    <span class="nav-section-title">Quick Actions</span>
                    <button class="nav-item quick-nav" data-prompt="Show me my latest 10 unread emails">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128236;</span></div>
                        <span class="nav-item-text">Unread Emails</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="Show my calendar events for today">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128197;</span></div>
                        <span class="nav-item-text">Today's Events</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="List my GitHub notifications">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128276;</span></div>
                        <span class="nav-item-text">GitHub Notifications</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="List my Google Chat spaces">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128172;</span></div>
                        <span class="nav-item-text">Chat Spaces</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="List my latest Google Drive files">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128193;</span></div>
                        <span class="nav-item-text">Drive Files</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="List my spreadsheets and sheet tabs">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128202;</span></div>
                        <span class="nav-item-text">Spreadsheets</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="Show my starred emails">
                        <div class="nav-item-icon"><span style="font-size:16px">&#11088;</span></div>
                        <span class="nav-item-text">Starred</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="Show my latest 10 Outlook emails">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128233;</span></div>
                        <span class="nav-item-text">Outlook Inbox</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="List my Google Docs">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128196;</span></div>
                        <span class="nav-item-text">My Docs</span>
                    </button>
                    <button class="nav-item quick-nav" data-prompt="List my Microsoft Teams">
                        <div class="nav-item-icon"><span style="font-size:16px">&#128101;</span></div>
                        <span class="nav-item-text">My Teams</span>
                    </button>
                </div>
            </nav>

            <div class="sidebar-footer">
                <p>Powered by OpenAI + Google + GitHub + Microsoft APIs</p>
            </div>
        </aside>

        <!-- Capabilities Modal -->
        <div class="modal-overlay" id="capabilitiesModal" style="display: none;">
            <div class="modal modal-large">
                <div class="modal-header">
                    <h2 id="modalTitle">All Tools</h2>
                    <button class="close-modal-btn" id="closeCapabilitiesBtn">&times;</button>
                </div>
                <div class="modal-content">
                    <div class="service-tabs" id="serviceTabs">
                        <button class="service-tab active" data-filter="all">All</button>
                        <button class="service-tab" data-filter="gmail">Gmail (25)</button>
                        <button class="service-tab" data-filter="gchat">Chat (3)</button>
                        <button class="service-tab" data-filter="drive">Drive (10)</button>
                        <button class="service-tab" data-filter="sheets">Sheets (10)</button>
                        <button class="service-tab" data-filter="github">GitHub (20)</button>
                        <button class="service-tab" data-filter="calendar">Calendar (19)</button>
                        <button class="service-tab" data-filter="outlook">Outlook (18)</button>
                        <button class="service-tab" data-filter="docs">Docs (8)</button>
                        <button class="service-tab" data-filter="teams">Teams (10)</button>
                    </div>
                    <div class="capability-group">
                        <p class="capability-description"><span id="toolStatusText">Not connected</span></p>
                        <div class="tools-container" id="toolsGrid">
                            <div style="color:var(--text-secondary)">Loading tools...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Gmail Panel (shown when Gmail is selected) -->
            <div class="service-panel" id="gmailPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#EA4335"
                                d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z" />
                        </svg>
                        <h2>Gmail Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="gmail">&times;</button>
                </div>

                <div class="panel-content">
                    <!-- Not Authenticated State -->
                    <div class="auth-section" id="authSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#EA4335"
                                        d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z" />
                                </svg>
                            </div>
                            <h3>Connect Your Gmail</h3>
                            <p>Sign in to unlock all 25 AI-powered email tools:</p>
                            <ul class="feature-list">
                                <li>Send, reply, forward emails</li>
                                <li>Search, read, and summarize</li>
                                <li>Star, archive, label management</li>
                                <li>Drafts, threads, batch operations</li>
                                <li>Multi-step agentic task execution</li>
                            </ul>
                            <button class="auth-btn" id="authenticateBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff"
                                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                                    <path fill="#fff"
                                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                    <path fill="#fff"
                                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                    <path fill="#fff"
                                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                                </svg>
                                Sign in with Google
                            </button>
                            <p class="auth-note">This also enables Google Calendar. Your data stays secure.</p>
                        </div>
                    </div>

                    <!-- Authenticated State -->
                    <div class="connected-section" id="connectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon">&#10003;</div>
                                <div>
                                    <h3>Gmail Connected</h3>
                                    <p>25 tools ready. Try complex multi-step tasks!</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn"
                                    data-prompt="Show me my latest 5 emails and summarize them">
                                    &#128236; Summarize Recent Emails
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Find all unread emails, read the most important one, and star it">
                                    &#11088; Find & Star Important
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Search for emails with attachments from the last 3 days and list what files they contain">
                                    &#128206; Recent Attachments
                                </button>
                                <button class="quick-action-btn" data-prompt="Help me compose a professional email">
                                    &#9997; Compose Email
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="gmail">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="gmailReauthBtn">Reauthenticate Google (Switch
                                Account)</button>
                        </div>
                    </div>

                    <!-- Setup Required State -->
                    <div class="setup-section" id="setupSection" style="display: none;">
                        <div class="setup-card">
                            <div class="setup-icon">&#9881;</div>
                            <h3>Setup Required</h3>
                            <p>Google Cloud credentials need to be configured first.</p>
                            <ol class="setup-steps">
                                <li>Go to <a href="https://console.cloud.google.com/" target="_blank">Google Cloud
                                        Console</a></li>
                                <li>Create a project & enable Gmail + Calendar APIs</li>
                                <li>Create OAuth 2.0 credentials (Web application)</li>
                                <li>Add <code>GMAIL_CLIENT_ID</code> and <code>GMAIL_CLIENT_SECRET</code> to your
                                    <code>.env</code> file</li>
                                <li>Restart the server</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar Panel -->
            <div class="service-panel" id="calendarPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#4285f4"
                                d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z" />
                        </svg>
                        <h2>Calendar Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="calendar">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="auth-section" id="calendarAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#4285f4"
                                        d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z" />
                                </svg>
                            </div>
                            <h3>Connect Google Calendar</h3>
                            <p>Sign in with Google to unlock 19 calendar tools:</p>
                            <ul class="feature-list">
                                <li>List, create, update, delete events</li>
                                <li>Quick add events with natural language</li>
                                <li>Check free/busy, manage attendees</li>
                                <li>Multiple calendars, recurring events</li>
                            </ul>
                            <button class="auth-btn" id="calendarAuthBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff"
                                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                                    <path fill="#fff"
                                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                    <path fill="#fff"
                                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                    <path fill="#fff"
                                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                                </svg>
                                Sign in with Google
                            </button>
                            <p class="auth-note">Uses the same Google OAuth as Gmail.</p>
                        </div>
                    </div>
                    <div class="connected-section" id="calendarConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#4285f4,#1a73e8)">
                                    &#10003;</div>
                                <div>
                                    <h3>Calendar Connected</h3>
                                    <p>19 tools ready. Manage events, check availability!</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="Show my calendar events for today">
                                    &#128197; Today's Events
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Create a meeting tomorrow at 2pm for 1 hour titled 'Team Sync'">
                                    &#10133; Create Event
                                </button>
                                <button class="quick-action-btn" data-prompt="Check my availability for this week">
                                    &#128338; Check Availability
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="calendar">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="calendarReauthBtn">Reauthenticate Calendar
                                (Switch Account)</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GitHub Panel -->
            <div class="service-panel" id="gchatPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#34a853" d="M3 4h18v12H7l-4 4V4zm4 5h10v2H7V9z" />
                        </svg>
                        <h2>Google Chat Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="gchat">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="auth-section" id="gchatAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#34a853" d="M3 4h18v12H7l-4 4V4zm4 5h10v2H7V9z" />
                                </svg>
                            </div>
                            <h3>Connect Google Chat</h3>
                            <p>Use Google OAuth to unlock chat space tools:</p>
                            <ul class="feature-list">
                                <li>List Google Chat spaces</li>
                                <li>Send messages to spaces</li>
                                <li>Read recent chat messages</li>
                            </ul>
                            <button class="auth-btn" id="gchatAuthBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff"
                                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                                    <path fill="#fff"
                                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                    <path fill="#fff"
                                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                    <path fill="#fff"
                                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                                </svg>
                                Sign in with Google
                            </button>
                            <p class="auth-note">Uses the same Google OAuth as Gmail and Calendar.</p>
                        </div>
                    </div>
                    <div class="connected-section" id="gchatConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#34a853,#16a34a)">
                                    &#10003;</div>
                                <div>
                                    <h3>Google Chat Connected</h3>
                                    <p>3 tools ready for space messaging workflows.</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="List my Google Chat spaces">
                                    &#128172; List Spaces
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="List my Google Chat spaces and send a hello message to the first one">
                                    &#9993; Send Space Message
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="List recent messages from a Google Chat space">
                                    &#128221; Read Recent Messages
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="gchat">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="gchatReauthBtn">Reauthenticate Chat (Switch
                                Account)</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Google Drive Panel -->
            <div class="service-panel" id="drivePanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#0f9d58" d="M8.5 3L3 12l2.75 4.5L11.25 7.5z" />
                            <path fill="#f4b400" d="M8.5 3h7L21 12h-7z" />
                            <path fill="#4285f4" d="M5.75 16.5h11.5L21 12h-7L10.25 18z" />
                        </svg>
                        <h2>Google Drive Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="drive">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="auth-section" id="driveAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#0f9d58" d="M8.5 3L3 12l2.75 4.5L11.25 7.5z" />
                                    <path fill="#f4b400" d="M8.5 3h7L21 12h-7z" />
                                    <path fill="#4285f4" d="M5.75 16.5h11.5L21 12h-7L10.25 18z" />
                                </svg>
                            </div>
                            <h3>Connect Google Drive</h3>
                            <p>Use Google OAuth to unlock 10 Drive tools:</p>
                            <ul class="feature-list">
                                <li>List and inspect files/folders</li>
                                <li>Create, update, move, copy files</li>
                                <li>Share files with teammates</li>
                                <li>Download readable file content</li>
                            </ul>
                            <button class="auth-btn" id="driveAuthBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff"
                                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                                    <path fill="#fff"
                                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                    <path fill="#fff"
                                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                    <path fill="#fff"
                                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                                </svg>
                                Sign in with Google
                            </button>
                            <p class="auth-note">Uses the same Google OAuth as Gmail, Calendar, and Chat.</p>
                        </div>
                    </div>
                    <div class="connected-section" id="driveConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#0f9d58,#4285f4)">
                                    &#10003;</div>
                                <div>
                                    <h3>Google Drive Connected</h3>
                                    <p>10 tools ready for file operations.</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="List my latest Google Drive files">
                                    &#128193; List Files
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Create a Drive folder called Team Docs and add a notes.txt file with today's updates">
                                    &#10133; Create Folder + File
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Find files modified this week and show who owns them">
                                    &#128269; Search Files
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="drive">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="driveReauthBtn">Reauthenticate Drive (Switch
                                Account)</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Google Sheets Panel -->
            <div class="service-panel" id="sheetsPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#34a853" d="M5 2h10l4 4v16H5z" />
                            <path fill="#fff" d="M9 10h6v1H9zm0 3h6v1H9zm0 3h6v1H9z" />
                        </svg>
                        <h2>Google Sheets Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="sheets">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="auth-section" id="sheetsAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#34a853" d="M5 2h10l4 4v16H5z" />
                                    <path fill="#fff" d="M9 10h6v1H9zm0 3h6v1H9zm0 3h6v1H9z" />
                                </svg>
                            </div>
                            <h3>Connect Google Sheets</h3>
                            <p>Use Google OAuth to unlock Sheets tools:</p>
                            <ul class="feature-list">
                                <li>List spreadsheets and sheet tabs</li>
                                <li>Read and write cell ranges</li>
                                <li>Append or clear rows</li>
                                <li>Create and manage tab sheets</li>
                            </ul>
                            <button class="auth-btn" id="sheetsAuthBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff"
                                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                                    <path fill="#fff"
                                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                    <path fill="#fff"
                                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                    <path fill="#fff"
                                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                                </svg>
                                Sign in with Google
                            </button>
                            <p class="auth-note">Uses the same Google OAuth as Gmail, Calendar, and Drive.</p>
                        </div>
                    </div>
                    <div class="connected-section" id="sheetsConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#34a853,#16a34a)">
                                    &#10003;</div>
                                <div>
                                    <h3>Google Sheets Connected</h3>
                                    <p>Sheets tools are ready for spreadsheet automation.</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="List my spreadsheets and tabs">
                                    &#128202; List Spreadsheets
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Create a spreadsheet called Weekly Tracker with tabs Summary and Tasks">
                                    &#10133; Create Spreadsheet
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Read values from Sheet1!A1:D20 in my latest spreadsheet">
                                    &#128214; Read Sheet Values
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="sheets">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="sheetsReauthBtn">Reauthenticate Sheets (Switch
                                Account)</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GitHub Panel -->
            <div class="service-panel" id="githubPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#e6edf3"
                                d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z" />
                        </svg>
                        <h2>GitHub Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="github">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="auth-section" id="githubAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#e6edf3"
                                        d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z" />
                                </svg>
                            </div>
                            <h3>Connect GitHub</h3>
                            <p>Sign in with GitHub to unlock 20 GitHub tools:</p>
                            <ul class="feature-list">
                                <li>Repos, issues, pull requests</li>
                                <li>Create branches, merge PRs</li>
                                <li>Search repos and code</li>
                                <li>Notifications, commits, gists</li>
                            </ul>
                            <button class="auth-btn github-auth-btn" id="githubAuthBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff"
                                        d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z" />
                                </svg>
                                Sign in with GitHub
                            </button>
                            <p class="auth-note" id="githubAuthNote">Configure <code>GITHUB_CLIENT_ID</code> and
                                <code>GITHUB_CLIENT_SECRET</code> in <code>.env</code>.</p>
                        </div>
                    </div>
                    <div class="connected-section" id="githubConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#238636,#2ea043)">
                                    &#10003;</div>
                                <div>
                                    <h3>GitHub Connected</h3>
                                    <p id="githubUsername">20 tools ready.</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="List my GitHub repositories">
                                    &#128193; My Repositories
                                </button>
                                <button class="quick-action-btn" data-prompt="Show my GitHub notifications">
                                    &#128276; Notifications
                                </button>
                                <button class="quick-action-btn" data-prompt="Show my GitHub profile">
                                    &#128100; My Profile
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="github">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="githubReauthBtn">Reauthenticate GitHub (Switch
                                Account)</button>
                            <button class="disconnect-btn" id="githubDisconnectBtn">Disconnect GitHub</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Google Docs Panel -->
            <div class="service-panel" id="docsPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#4285F4" d="M6 2h8l6 6v12c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2z"/>
                            <path fill="#fff" d="M7 12h10v1.5H7zm0 3h7v1.5H7zm0-6h10v1.5H7z"/>
                        </svg>
                        <h2>Google Docs Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="docs">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="connected-section" id="docsConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon">&#10003;</div>
                                <div>
                                    <h3>Google Docs Connected</h3>
                                    <p>8 document tools ready. Create, edit, and read Google Docs!</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="List my Google Docs">List My Docs</button>
                                <button class="quick-action-btn" data-prompt="Create a new Google Doc titled 'Meeting Notes'">Create Doc</button>
                            </div>
                            <button class="start-chat-btn" data-panel="docs">Start Chatting</button>
                        </div>
                    </div>
                    <div class="auth-section" id="docsAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#4285F4" d="M6 2h8l6 6v12c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2z"/>
                                    <path fill="#fff" d="M7 12h10v1.5H7zm0 3h7v1.5H7zm0-6h10v1.5H7z"/>
                                </svg>
                            </div>
                            <h3>Connect Google Docs</h3>
                            <p>Google Docs shares authentication with Gmail. Connect Gmail first to enable Docs tools.</p>
                            <p class="auth-note">If already connected to Gmail but Docs isn't working, reauthenticate Docs to grant the Docs scope.</p>
                            <button class="disconnect-btn reauth-btn" id="docsReauthBtn">Reauthenticate Docs (Switch Account)</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Microsoft Teams Panel -->
            <div class="service-panel" id="teamsPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#6264A7" d="M20.5 6a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM16 3.5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zM22 9h-4v10c0 .55-.45 1-1 1h-6c0 2.21 1.79 4 4 4h3c2.21 0 4-1.79 4-4V9zM15 8H3c-.55 0-1 .45-1 1v8c0 2.76 2.24 5 5 5h4c2.76 0 5-2.24 5-5V9c0-.55-.45-1-1-1z"/>
                        </svg>
                        <h2>Microsoft Teams Integration</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="teams">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="connected-section" id="teamsConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon">&#10003;</div>
                                <div>
                                    <h3>Microsoft Teams Connected</h3>
                                    <p id="teamsUserInfo">10 team collaboration tools ready!</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="List my Microsoft Teams">List Teams</button>
                                <button class="quick-action-btn" data-prompt="List my Teams chats">List Chats</button>
                            </div>
                            <button class="start-chat-btn" data-panel="teams">Start Chatting</button>
                            <button class="disconnect-btn" id="teamsDisconnectBtn">Disconnect Teams</button>
                        </div>
                    </div>
                    <div class="auth-section" id="teamsAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#6264A7" d="M20.5 6a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM16 3.5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zM22 9h-4v10c0 .55-.45 1-1 1h-6c0 2.21 1.79 4 4 4h3c2.21 0 4-1.79 4-4V9zM15 8H3c-.55 0-1 .45-1 1v8c0 2.76 2.24 5 5 5h4c2.76 0 5-2.24 5-5V9c0-.55-.45-1-1-1z"/>
                                </svg>
                            </div>
                            <h3>Connect Microsoft Teams</h3>
                            <p>Sign in with your Microsoft account to access Teams, channels, and chats.</p>
                            <button class="auth-btn teams-auth-btn" id="teamsAuthBtn">
                                <svg viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#fff" d="M20.5 6a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM16 3.5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0z"/>
                                </svg>
                                Connect with Microsoft
                            </button>
                            <p class="auth-note">Uses Microsoft OAuth (same as Outlook). You may need to re-authenticate to grant Teams permissions.</p>
                        </div>
                    </div>
                    <div class="setup-section" id="teamsSetupSection" style="display: none;">
                        <div class="setup-card">
                            <div class="setup-icon">&#9881;</div>
                            <h3>Setup Required</h3>
                            <p>Microsoft OAuth credentials needed. Same credentials as Outlook.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Outlook Panel -->
            <div class="service-panel" id="outlookPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#0078D4"
                                d="M24 7.387v10.478c0 .23-.08.424-.238.582a.793.793 0 01-.582.238h-9.462V7.07l1.2.72 8.844-5.073c.158.05.29.147.396.293.106.147.159.312.159.494v.17L24 7.387zM13.718 7.07v12.078H1.077a.83.83 0 01-.618-.259A.861.861 0 010 18.25V4.387c0-.11.037-.18.11-.213l6.6-3.83L13.717 7.07z" />
                        </svg>
                        <h2>Outlook</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="outlook">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="auth-section" id="outlookAuthSection">
                        <div class="auth-card">
                            <div class="auth-icon">
                                <svg viewBox="0 0 24 24" width="64" height="64">
                                    <path fill="#0078D4"
                                        d="M24 7.387v10.478c0 .23-.08.424-.238.582a.793.793 0 01-.582.238h-9.462V7.07l1.2.72 8.844-5.073c.158.05.29.147.396.293.106.147.159.312.159.494v.17L24 7.387zM13.718 7.07v12.078H1.077a.83.83 0 01-.618-.259A.861.861 0 010 18.25V4.387c0-.11.037-.18.11-.213l6.6-3.83L13.717 7.07z" />
                                </svg>
                            </div>
                            <h3>Connect Outlook</h3>
                            <p>Sign in with Microsoft to unlock 18 Outlook email tools:</p>
                            <ul class="feature-list">
                                <li>Send, reply, forward emails</li>
                                <li>Search, read, and organize</li>
                                <li>Flag, folders, draft management</li>
                                <li>Cross-service workflows with Gmail & GitHub</li>
                            </ul>
                            <button class="auth-btn outlook-auth-btn" id="outlookAuthBtn">
                                <svg viewBox="0 0 21 21" width="20" height="20">
                                    <rect x="1" y="1" width="9" height="9" fill="#f25022" />
                                    <rect x="11" y="1" width="9" height="9" fill="#7fba00" />
                                    <rect x="1" y="11" width="9" height="9" fill="#00a4ef" />
                                    <rect x="11" y="11" width="9" height="9" fill="#ffb900" />
                                </svg>
                                Sign in with Microsoft
                            </button>
                            <p class="auth-note" id="outlookAuthNote">Configure <code>OUTLOOK_CLIENT_ID</code> and
                                <code>OUTLOOK_CLIENT_SECRET</code> in <code>.env</code>.</p>
                        </div>
                    </div>
                    <div class="connected-section" id="outlookConnectedSection" style="display: none;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#0078D4,#005a9e)">
                                    &#10003;</div>
                                <div>
                                    <h3>Outlook Connected</h3>
                                    <p id="outlookUserEmailDisplay">18 tools ready.</p>
                                </div>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" data-prompt="Show my latest 10 Outlook emails">
                                    &#128233; Inbox Emails
                                </button>
                                <button class="quick-action-btn"
                                    data-prompt="Search Outlook for emails with attachments from this week">
                                    &#128206; Recent Attachments
                                </button>
                                <button class="quick-action-btn" data-prompt="List my Outlook folders">
                                    &#128193; Mail Folders
                                </button>
                            </div>
                            <button class="start-chat-btn" data-panel="outlook">
                                Start Chatting
                            </button>
                            <button class="disconnect-btn reauth-btn" id="outlookReauthBtn">Reauthenticate Outlook
                                (Switch Account)</button>
                            <button class="disconnect-btn" id="outlookDisconnectBtn">Disconnect Outlook</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Timer Tasks Panel -->
            <div class="service-panel" id="timerPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg viewBox="0 0 24 24" width="28" height="28">
                            <path fill="#f59e0b"
                                d="M15 1H9v2h6V1zm-3 4C7.58 5 4 8.58 4 13s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3.65 11.35-4.15-2.5V8h1.5v4.98l3.42 2.06-.77 1.31z" />
                        </svg>
                        <h2>Timer Tasks</h2>
                    </div>
                    <button class="close-panel-btn" data-panel="timer">&times;</button>
                </div>
                <div class="panel-content">
                    <div class="connected-section" style="display: block;">
                        <div class="connected-card">
                            <div class="connected-header">
                                <div class="connected-icon" style="background:linear-gradient(135deg,#f59e0b,#d97706)">
                                    &#9201;</div>
                                <div>
                                    <h3>Automate Timed Instructions</h3>
                                    <p id="timerTaskStatusText">No tasks configured yet.</p>
                                </div>
                            </div>

                            <div class="token-input-group">
                                <input class="token-input" id="timerTaskNameInput" type="text"
                                    placeholder="Task name (e.g. Daily timesheet guard)">
                                <input class="token-input" id="timerTaskTimeInput" type="time" value="17:00">
                                <textarea class="token-input timer-task-textarea" id="timerTaskInstructionInput"
                                    rows="4"
                                    placeholder="Instruction to run at that time (e.g., Check today's timesheet row, and if empty, fill it using last 3 days context)."></textarea>
                                <label class="timer-task-checkbox">
                                    <input id="timerTaskEnabledInput" type="checkbox" checked>
                                    Enable immediately
                                </label>
                            </div>

                            <div class="quick-actions">
                                <button class="quick-action-btn" id="timerTaskSaveBtn">
                                    &#128190; Save Timer Task
                                </button>
                                <button class="quick-action-btn" id="timerTaskRefreshBtn">
                                    &#128260; Refresh Tasks
                                </button>
                            </div>

                            <div id="timerTaskList" class="timer-task-list"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Area -->
            <div class="chat-area" id="chatArea">
                <div class="chat-header">
                    <h2>Chat</h2>
                    <div class="chat-status" id="chatStatus">
                        <span class="service-badge gmail-badge" id="gmailBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Gmail
                        </span>
                        <span class="service-badge calendar-badge" id="calendarBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Calendar
                        </span>
                        <span class="service-badge github-badge" id="githubBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            GitHub
                        </span>
                        <span class="service-badge gchat-badge" id="gchatBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Chat
                        </span>
                        <span class="service-badge drive-badge" id="driveBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Drive
                        </span>
                        <span class="service-badge sheets-badge" id="sheetsBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Sheets
                        </span>
                        <span class="service-badge outlook-badge" id="outlookBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Outlook
                        </span>
                        <span class="service-badge docs-badge" id="docsBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Docs
                        </span>
                        <span class="service-badge teams-badge" id="teamsBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Teams
                        </span>
                        <span class="service-badge timer-badge" id="timerBadge" style="display: none;">
                            <span class="badge-dot"></span>
                            Timer
                        </span>
                        <span class="turns-badge" id="turnsBadge" style="display: none;">
                            Steps: <span id="turnsCount">0</span>/15
                        </span>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <!-- Welcome Message -->
                    <div class="message assistant">
                        <div class="message-avatar">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <circle cx="12" cy="12" r="10" fill="none" stroke="#6366f1" stroke-width="2" />
                                <path fill="none" stroke="#6366f1" stroke-width="2" d="M8 12l3 3 5-6" />
                            </svg>
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>Hello! I'm your AI Agent with tools across Gmail, Google Calendar, Google Chat,
                                    Google Drive, Google Sheets, and GitHub. I can chain <strong>up to 15 steps</strong>
                                    to complete complex cross-service tasks.</p>
                                <p>Connect services in the sidebar, then try things like:</p>
                                <ul style="margin:0.5rem 0;padding-left:1.2rem;color:var(--text-secondary)">
                                    <li>"Find today's meetings and email the attendees a reminder"</li>
                                    <li>"Create a GitHub issue for the bug and schedule a review meeting"</li>
                                    <li>"List my open PRs and send me a summary email"</li>
                                    <li>"List my spreadsheets, update a range, and share the file in Drive"</li>
                                    <li>"Search for emails from my team, star the important ones, and create calendar
                                        events for follow-ups"</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="chat-input-container">
                    <div class="input-wrapper">
                        <textarea id="messageInput"
                            placeholder="Ask me anything across Gmail, Calendar, Chat, Drive, Sheets, or GitHub..."
                            rows="1"></textarea>
                        <button class="mic-btn" id="micBtn" title="Speak to type">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" y1="19" x2="12" y2="23" />
                                <line x1="8" y1="23" x2="16" y2="23" />
                            </svg>
                        </button>
                        <button class="send-btn" id="sendBtn" disabled>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" />
                            </svg>
                        </button>
                    </div>
                    <p class="input-hint">Press Enter to send &bull; Shift+Enter for new line &bull; Agent chains up to
                        15 steps automatically</p>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>

</html>